{% extends "layout.html" %}

{% block title %}Home{% endblock %}

{% block content %}
<h1 id="home-title">Home</h1>

<div class="sensors" id="sensors-div">
    <!-- TEMPERATURE + HUMIDITY -->
    <div id="temp-humid-div" class="temp-humid sensor-subsection">
        <!-- IMG -->

        <!-- TITLE -->

        <!-- DATA READING -->
        <p><strong>Temperature:</strong> <span id="temperature">Loading...</span></p>
        <p><strong>Humidity:</strong> <span id="humidity">Loading...</span></p>

        <!-- MANUAL ACCESS -->
    </div>

    <!-- AIR QUALITY -->
    <div id="air-quality-div" class="air-quality sensor-subsection">
        
        <!-- IMG -->

        <!-- TITLE -->

        <!-- DATA READING -->
        <p><strong>Field:</strong> <span id="pm25">Loading...</span></p>
        <p><strong>Field:</strong> <span id="pm10">Loading...</span></p>

        <!-- MANUAL ACCESS -->
    </div>

    <!-- MOTION SENSOR + LED -->
    <div id="motion-div" class="motion sensor-subsection">
        <!-- IMG -->

        <!-- TITLE -->

        <!-- DATA READING -->

        <!-- MANUAL ACCESS -->
    </div>

</div>

<script>
    // Function to fetch the latest sensor data
    function updateSensorDisplay() {
        fetch('/data')
            .then(response => response.json())
            .then(data => {
                // Assume we are displaying data for a specific device_id
                const deviceId = 'temp_humidity_sensor';
                const deviceData = data[deviceId];

                if (deviceData) {
                    document.getElementById('temperature').textContent = deviceData.temperature + ' Â°C';
                    document.getElementById('humidity').textContent = deviceData.humidity + ' %';
                } else {
                    console.warn('Device ID not found in data:', deviceId);
                }
            })
            .catch(error => console.error('Error fetching sensor data:', error));
    }

    // Periodically update the data every 5 seconds
    setInterval(updateSensorDisplay, 5000);

    // Initial update when the page loads
    window.onload = updateSensorDisplay;
</script>
{% endblock %}
